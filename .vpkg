#!/usr/bin/env bash
#
# .vpkg for httpcat
#

default_version="0.0.1"

install() {
  
  # args
  name="$1"
  version="$2"
  sourceVersion="$3"
  
  # defaults
  [ -z "$version" ] && version="$default_version"
  [ -z "$sourceVersion" ] && sourceVersion="$version"
  
  # usage
  [ -z "$VPKG_ROOT" ] && echo '$VPKG_ROOT must be defined' >&2 && exit 1
  [ -z "$name" ] && echo "please specify a name" >&2 && exit 1
  
  # get repo into the right state
  git fetch --all
  git fetch --tags
  git checkout "$sourceVersion"
  
  # copy over the source files
  cp -R "$VPKG_ROOT"/src/"$name" "$VPKG_ROOT"/lib/"$name"/"$version"
}
